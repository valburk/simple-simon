<!DOCTYPE html>
<html>
	<head>
	    <title>Simple Simon</title>
	    <link rel="stylesheet" href="CSS/simon.css">
	    <link href="https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300" rel="stylesheet">
	</head>
	<body>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	    <div id=gameBox>
	    <h1 id="title">Simple Simon</h1>
	    <h1 id="over"> </h1>
	    <h2 id="subtitle">Click start to play!</h2>
	    <div id="box-red" class="box">1</div>
	    <div id="box-yellow" class="box">2</div>
	    <div id="box-green" class="box">3</div>
	    <div id="box-blue" class="box">4</div>
	    <button id="start"> Start</button> 
	    </div>
	<script>
	// (function() {
    "use strict";
	var sequenceArray = [];
	var counter = 1;
	var userArray = [];


 	function addToSequence(){
 		var num = (Math.floor(Math.random()* 4)+1);
 		sequenceArray.push(num);
 		userArray = [];
 	}

 	function animateGame(){
	    var i = 0;
	    var intervalId = setInterval(function() {
			if(i >= sequenceArray.length) {
				clearInterval(intervalId);
	        }
	        animate(i);
		 	i++;
	    }, 800);
	}

 	function animate(i){
 		var rounds = document.getElementById('subtitle');
            rounds.innerHTML = "Round " + (parseInt(sequenceArray.length));
	 	if(sequenceArray[i] == 1){
	 		$("#box-red").animate({
	 			opacity: .5
	 		}, 500, function(){
	 			$("#box-red").animate({opacity: 1}, 500);
	 		})
	 	}else if(sequenceArray[i] == 2){
	 		$("#box-yellow").animate({
	 			opacity: .5
	 		}, 500, function(){
	 			$("#box-yellow").animate({opacity: 1}, 500);
	 		})
	 	}else if(sequenceArray[i] == 3){
	 		$("#box-green").animate({
	 			opacity: .5
	 		}, 500, function(){
	 			$("#box-green").animate({opacity: 1}, 500);
	 		})
	 	}else if(sequenceArray[i] == 4){
	 		$("#box-blue").animate({
	 			opacity: .5
	 		}, 500, function(){
	 			$("#box-blue").animate({opacity: 1}, 500);
	 		})
	 	}
 	}

 	function checkUser(button){	
		if(userArray[counter] == sequenceArray[counter]) {
			if(counter == sequenceArray.length -1 ){
				counter = 0;
				addToSequence();
				animateGame();
			}else{
				counter++;
			}
		}else{
			gameOver();	
		}
	}

	function playerMove(){
		$('.box').click(function(){
			userArray.push($(this).text());
			checkUser($(this));
	    }); 
	}
 
	function start(){
	    $("#start").click(function(){
	    	sequenceArray = [];
	    	userArray = [];
	    	counter = 0;
	    	addToSequence();
	    	animateGame();
	    	playerMove();
            var loser = document.getElementById('over');
           	loser.innerHTML = "";
	    	
		});
	}
	
	function gameOver(){
		sequenceArray = [];
	    userArray = [];
	    counter = 0;
	    	var rounds = document.getElementById('subtitle');
            rounds.innerHTML = " ";
	    var playAgain = document.getElementById('subtitle');
            playAgain.innerHTML = "Click Start to play Again!";
        var loser = document.getElementById('over');
           loser.innerHTML = "GAME OVER";
	}
	start();


    // })();
	</script>
	    
	</body>
</html>